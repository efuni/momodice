
## MOMO_DND_PROJECT 说明文档  
*对应版本 : 0.25.6*  
*0.23.0及以上为beta版本。架构更新。如有bug欢迎汇报给开发者。*   

MOMO_DND_PROJECT是一个为DnD研发的跑团机器人项目(以下简称为桃桃姬)。  

#### 特性  
* 桃桃姬是为DND跑团中复杂战斗场景的**自动化**需求而设计，她拥有强大的自动化功能，可以自主完成一系列的触发机制。     
* 桃桃姬的一切指令设计源于便捷，你可以完成一系列复杂的检定而将指令控制在数个字符以内。   
* 桃桃姬使用动态检定结果，动作的执行者和被执行者可以使用二次检定等手段使得检定结果发生改变。    
* 桃桃姬拥有强大的记录功能，可以存储包括具有时效性buff，环位在内的大部分游戏数据。   

如果你是一名玩家而非DM，了解如何上传人物卡(第三章)以及如何进行四大常用进阶检定(第四章)后即可快速入门。     
如果你是一名DM有定制需求，欢迎联系开发者来完善桃桃姬的模块。也可以通过.master发送给开发者私信来申请定制功能。    
如果桃桃姬在游戏过程中出现任何故障，欢迎联系开发者(联系方法详见第二章)。  

------

### 〇、术语  

#### 骰子  
什么是骰子？在DnD的世界中(万物均由骰子构成)，无时不刻需要使用到骰子。  
对于六面骰你一定相当熟悉，它的6个面分别记录了1至6的数字。然而包含六面骰在内我们需要使用到4面骰(D4)，6面骰(D6)，8面骰(D8)，两种10面骰(D10)，12面骰(D12)，以及最常用的20面骰(D20)。  
抛出骰子，你会得到相应的结果。这些结果(数值)通常会对应游戏中的相应展开。  

#### 伤害类型/伤害类型标签  
在某些汉化文本中，会出现不同的译名。例如将冷冻翻译为冰冻、强酸翻译为腐蚀、毒素翻译为剧毒等……   
桃桃姬需要处理任何有关伤害类型的标签或指令时，请使用以下标准术语。  
穿刺,挥砍,钝击,强酸,冷冻,火焰,力场,闪电,黯蚀,毒素,心灵,光耀,雷鸣  
如果你不这么做，部分功能会受到限制甚至无法执行。  

#### 技能/属性/豁免检定名称  
以下的名称可以被桃桃姬识别，在录入或进行检定时请参照下表名称。  

**豁免类**  
力量豁免,敏捷豁免,体质豁免,智力豁免,感知豁免,魅力豁免,专注豁免   

专注豁免:维持法术时进行的体质豁免，受到很多效应的影响，因此单独作为一个分支列出。  

**属性类**  
力量,敏捷,体质,智力,感知,魅力,先攻  

先攻:敏捷检定的一种，受到很多效应的影响，因此单独作为一个分支列出。  

**技能类**  
运动,体操,巧手,隐匿,奥秘,历史,调查,自然,宗教,驯兽,洞悉,医药,察觉,求生,欺瞒,威吓,表演,游说  

------

### 一、基础检定  
DnD世界中，一切事件均会遵循投掷出的结果展开。你需要了解如何进行基础检定。  

1. **如何抛出骰子**  
一切形如<kbd>.rd</kbd>或<kbd>.rxdy</kbd>或<kbd>.d</kbd>或<kbd>.xdy</kbd>的指令均会被桃桃姬认可。x与y为选填，其中x对应骰子数量(默认为1)，y对应骰子面数(默认为20)。我们可以看一些范例:    
> .d 投掷一个20面骰  
.r2d 投掷两个20面骰  
.4d12 投掷4个12面骰  
.8d6 投掷8个六面骰  

2. **如何进行复杂的骰子表达式的运算**  
你可以像使用正常运算一般在骰子表达式中使用加减乘除。尝试理解以下内容:  
> .d+(d+2d+6d12+3)/d  

!> 请注意，检定的开头请务必以.xdy或.rxdy的形式。请避免括号等特殊符号的出现。如果你如论如何都需要使用特殊符号在表达式的开头，请将开头替换为 .0d+ 或 .d0+。

------

### 二、其他指令   
#### 群聊相关   
<kbd>.msg_off</kbd> 关闭群消息监听。(这会停止桃桃姬在本群中的一切功能)  
  
<kbd>.msg_on</kbd> 开启群消息监听。   

<kbd>.dice_off</kbd> 仅关闭基础检定功能。(基础检定:详见第一章)  
  
<kbd>.dice_on</kbd> 开启基础检定功能。   

<kbd>.master 消息A</kbd> 向开发者发送内容为消息A的消息。  

#### 建卡相关  
<kbd>.随机属性 n</kbd> 根据PHB的D6四选三规则随机生成n项人物属性。  

#### 状态检查   
<kbd>.环位</kbd>或<kbd>.状态</kbd>查看当前选中角色的各项状态。   

#### 存档与读档    
<kbd>.save</kbd>与<kbd>.load</kbd>从服务器上传或读取你当前角色的状态数据。   

#### 法术查询   
<kbd>.s name1</kbd> 查询名为name1的法术信息。(支持英文)   

#### 战斗轮模块   
详见第五章时间模块。  

------

### 三、角色构成  
很多情况下，我们的检定会变得比想象中的复杂。伴随着角色的成长，与获得的新能力，检定会需要增加各种各样的参数。有时，一个动作会需要多种检定同时协作。如果你分别为每种检定进行投掷，会浪费大量的时间。创建你的角色，并把角色的特性告诉桃桃姬。如此，她就可以代替你进行更加复杂的检定。  

!> 桃桃姬可以代替你完成复杂的检定。但是我强烈建议你在了解这些机制是如何在DnD中运作的情况下使用这些功能。  
  
!> 禁止在录入数据中出现任何与政治、涩情、敏感词汇有关的词语。否则你可能将会无法再使用桃桃姬的一切功能。  

使用<kbd>.set</kbd>指令以创建你的角色。(在将来，也许会推出网页版角色数据生成器。)   
.set <kbd>种族</kbd>,<kbd>职业与职业等级</kbd>,<kbd>生命值</kbd>,<kbd>当前生命值</kbd>,<kbd>当前剩余生命骰</kbd>,<kbd>力量</kbd>,<kbd>敏捷</kbd>,<kbd>体质</kbd>,<kbd>智力</kbd>,<kbd>感知</kbd>,<kbd>魅力</kbd>,<kbd>护甲等级</kbd>,\[<kbd>武器名(简洁即可)</kbd> <kbd>熟练武器(熟练项填1,非熟练填0)</kbd> <kbd>使用属性(例如STR,DEX,CHA.也可以是数字)</kbd> <kbd>伤害</kbd>\],\[<kbd>武器2,如果没有填None</kbd>\],\[<kbd>武器3,如果没有填None</kbd>\],\[<kbd>武器4,如果没有填None</kbd>\],<kbd>人物等级</kbd>,<kbd>人物名</kbd>,\[<kbd>技能与特质</kbd>\]  

!> 在录入时请注意输入的符号，例如空格是否为半角空格，逗号(括号)是否为英文逗号(括号)。这些都会导致录入失败。  

!> 请注意，一个qq账号在同一时间只可以选中一名角色。无论你身处哪里，桃桃姬只会认准你的qq账号为唯一id。  

示例如下:   

> .set 精灵,\*游荡者12,80,80,12,13,19,14,13,14,14,19,[匕首 1 DEX 1D6<穿刺>+1D6<毒素>+2],[弓 1 DEX 1D6<穿刺>+1],None,None,12,玛拉,[求生 调查* 敏捷豁免 感知豁免 精灵之准+ 隐匿* 毒素免疫- 光耀抗性- 火焰易伤-]

> .set 矮人,游侠7 \*法师2 战士2,58,58,6,19,14,16,8,10,12,20,[弓 1 DEX 1D6<穿刺>+1],None,None,None,11,德拉克小战锤,[历史 奥秘* 调查* 敏捷豁免 体质豁免 隐匿 苦痛魔爆+ 幸运石+ 敏捷豁免= 火焰抗性-]

在你的角色创建完成后，使用<kbd>.select</kbd>指令选择你所创建的角色。  

> .select 德拉克小战锤   

**快捷编号**  
当你召唤你的角色后，桃桃姬会为你的角色进行编号(通常是数字)。该功能服务于**快速选定目标**功能，你会在之后的章节中中详细了解这一点。   

**导出角色**   
在选中角色后尝试使用<kbd>.output</kbd>功能导出你的角色，这项指令包含了一系列查错机制，如果能够执行成功，说明你所创建的角色数据格式大致无误。  

#### 进阶录入规则  

**职业与职业等级**  
如果你选用了兼职规则，请用空格隔开复数职业。主要施法者职业请在职业前加注<kbd>*</kbd>。示例如下:  
> 游侠7 *法师10 战士2  

**武器**  
需要注意的是，拳头等是不需要录入的武器，桃桃姬会根据职业特性和规则自动生成，如果你使用相同的武器名称，则会优先使用你录入的数据:  
* 如果一件物品拥有魔法物品所带来的加值(例如+1)，你可以在伤害公式的**最后**加入这个加值。   

> [匕首 1 DEX 1D4<穿刺>] --> [匕首 1 DEX 1D4<穿刺>+1]  

* 你需要在伤害后增加伤害类型的标签，桃桃姬会分类计算伤害。  

> [匕首 1 DEX 1D4] --> [匕首 1 DEX 1D4<穿刺>+1]  

* 伤害表达式中**首个**被贴上的伤害类型标签会默认为武器伤害标签。它将会被计入各项加值，例如属性调整值、魔法物品加值等等。  
在下面的示例中，+6和+1的加值都会计入穿刺伤害中：  

> [霜刺 1 DEX 1D6<穿刺>+2D6<冷冻>+6+1]  

!> 请不要为物品的魔法加值附加伤害类型标签。以下的示例是错误的，请不要这样做，否则会导致桃桃姬无法辨认魔法物品加值:   
[霜刺 1 DEX 1D6<穿刺>+1D4<寒冷>+1<寒冷>]  <-- 这是**错误**的示范  

* **使用固定加值代替属性加值**  
如果武器数据时将使用属性改为了数字，例如8，那么在进行攻击判定时会将此值视为攻击加值，而不会计算你的人物属性属性带来的加值。并且伤害检定中不会使用此加值。本功能一般用于DM在制作怪物时的武器设定，不推荐玩家使用。    
> [弓 0 8 1D6<穿刺>+1]   
[巨剑 0 11 2D6<挥砍>+3]  

* **需豁免检定的攻击方式**  
某些特殊的能力需要目标进行豁免检定来计算受到的伤害(这类似于某些法术的效应，比如火球术，圣火术)。而不是通过骰出攻击骰来决定是否命中该目标。  
你可以通过修改第二项和第三项的内容来达成上述效果。  
你可以将使用属性项(第三项)改为STRS,DEXS,CONS,INTS,WISS,CHAS(它们分别对应了六大属性的豁免检定)中的任意一项，如此桃桃姬便会得知这是一个需要目标进行豁免的攻击方式。  
同时，第二项如果填写0(原本为武器熟练项)，则代表豁免成功不会受伤，如果填写1，则代表豁免成功伤害减半。默认会使用人物的主要施法属性来计算DC值，如果你想定义DC，请参考下文说明。   
> [火球术 1 DEXS 6D8<火焰>]   

* **定义武器种类(可选)**  
第五项定义了武器的种类。现在可选的属性只有近战、远程和法术三个选项。如果武器不填写第五项，那么默认为近战武器。在当前开发版本，只有远程武器才可以使用弹药系统。     
> [弓 1 DEX 1D6<穿刺>+1 远程]   
[巨剑 1 STR 2D6<挥砍>+3 近战]   

* **定义武器属性(可选)**  
第六项往后的所有条目定义了武器的属性。对于需要攻击检定的攻击方式(例如武器)，你可以为武器添加注入灵巧，双手，重型等武器属性。     
对于需要豁免检定的攻击方式，你可以添加像DC16这样的词条，来自定义检定难度等级。   
> [火球术 1 DEXS 6D8<火焰> 法术 DC30]   
[巨剑 1 STR 2D6<挥砍>+3 近战 双手 重型]   


**技能与特质**  
技能与特质，包括了以下的分支:  
> 技能熟练项与专精技能  
被动特质/提供被动特质的物品    
计算充能的物品  
伤害易伤、抗性与免疫  

每一条项目用空格隔开,专精技能(双倍熟练加值)后加<kbd>*</kbd>,被动特质后加<kbd>+</kbd>,伤害抗性、免疫相关后加<kbd>-</kbd>,优势技能后加<kbd>=</kbd>。  
尝试理解以下录入内容:  
> [敏捷豁免* 苦痛魔爆+ 黯蚀易伤- 光耀免疫- 力量= 历史=]    

------

### 四、进阶检定和功能
在上传并选择了你的角色后，桃桃姬可以执行如下的检定功能。  

#### 法术检定  
法术检定是桃桃姬的一个独立模块，收录了PHB中的所有法术以及大部分拓展中500多项法术信息。其中，攻击和豁免类法术支持选定目标检定，攻击类法术支持二次检定。  
使用<kbd>..m</kbd> <kbd>法术名称</kbd> <kbd>可选检定参数</kbd>指令进行法术检定。  
如果你使用法术检定，那么桃桃姬会同时扣除相应的环位资源。当前剩余的环位可使用指令<kbd>.环位</kbd>查看，使用指令<kbd>..longrest</kbd>可恢复所有环位。若不希望消耗环位，请在可选参数中增加<kbd>特殊</kbd>参数。    
##### 升环检定   
在名称后加入<kbd>+x</kbd>的检定参数(不需要空格)。示例如下:  
> ..m 魔法飞弹+4  
..m 灼热射线+3 优势  

#### 属性与技能检定  
属性检定的名称请参考PHB中的译名。  
使用<kbd>..s</kbd> <kbd>属性名称</kbd> <kbd>可选检定参数</kbd>指令进行属性与技能检定。示例如下:    
>..s 体质豁免 优势  
..s 智力  
..s 求生  

#### 攻击与伤害检定  
根据你录入的四种武器名称攻击配合人物调整值进行相应的检定。如果名称未填写，会默认为拳击。  
使用<kbd>..a</kbd> <kbd>武器名称</kbd> <kbd>可选检定参数</kbd>指令进行攻击与伤害检定。示例如下:  
>..a 优势  
..a 斧 劣势  

**进阶功能:选定目标**  
如果你为一次攻击指定了目标，那么本次攻击还会计算目标的AC值。以及命中后所造成的实际伤害。  
如果目标存在需要维持专注的法术，那么同时会触发体质豁免(专注)。如果目标存在受攻击触发效应(火焰护盾)，也同时会触发这些效应。  
需要注意的是，如果某次攻击命中并造成了伤害，这并不会直接扣除目标角色的HP。考虑到DnD中存在很多受攻击后或受攻击时可执行的反应动作。在解决这些问题之前，仍然需要手动扣除生命值。  

**为每次行动指定目标**   
你也可以随时在命令后加上目标的全称，或者是目标的快捷编号，你可以通过<kbd>.所有角色</kbd>指令查看当前群内所有已创建的生物的快捷编号:    
>*指令 参数=名称*  
*指令 参数=名称1,名称2,名称3*  
*指令 参数=编号*  
*指令 参数=编号1,编号2,编号3*   

这样桃桃姬就会在当前群内搜索已经被创建的角色的名字。并将他们设为本次行动的目标。  
尝试理解以下指令:  
>..a 斧 优势 光翼 =德拉克战锤,德拉克铁锤  
..a 长弓 咒剑 劣势 =2,3,4   
..a 短剑 =1   

**设置默认目标**   
你还可以通过<kbd>..=目标1,目标2</kbd>的指令来为你的某个角色设置默认的行动目标。这样一来，你就不比每次输入指令时都选定目标。你可以随时通过该指令来设置新的默认行动目标。   
需要注意的是，默认目标只会在你**没有**在行动指令中指定目标时才会被读取。如果你为某次攻击指令指定了一个或多个目标，那么默认目标不会生效。     
>*..=1*    
*..=2,10,12*   
*..=德拉克战锤,德拉克铜锤,德拉克铁锤*    
*..=德拉克秘银锤*    

#### 二次检定  
二次检定意味着动态的结果。在动作生效后、做出下一个动作前，执行动作的人可以通过二次检定影响此次动作的结果。
而动作指向的目标则具有更大的灵活性，如果这是一次攻击动作，你可以使用护盾术来改变你的护甲，从而使得针对你发动的攻击结果产生变化。如果这是一次需要豁免检定的攻击，那么目标可以通过尝试执行二次检定加入激励等检定参数来尝试影响攻击者的行动结果。我明白这也许不是那么容易理解，你可以通过下列指令段来理解二次检定的作用。          
在执行了一次检定(动作)后，动作执行者或动作指向目标可以通过使用<kbd>..l 参数1 参数2 ...</kbd>或<kbd>..L 参数1 参数2 ...</kbd>这样的形式的指令进行二次检定。  
* 参数是*可选*的，你可以不填写任何参数。
* 该功能支持攻击与伤害检定、法术检定。  

尝试理解以下指令段：  
>..s 历史  
桃桃姬:"...结果为10..."  
..l 激励  
桃桃姬:"...结果为18..."  

>..a 斧 劣势  
桃桃姬:"...未命中..."  
..l 激励  

>..a 巨剑 优势 咒剑  
桃桃姬:"...重击..."  
..l 魔能斩击  

>DM:  
..a 弯刀 =玩家A  
桃桃姬:"...命中..."  
玩家A:  
..m 护盾术  
DM:  
..l  
桃桃姬:"...未命中..."  

>玩家A:  
..激励 D10  
DM:  
..m 火球术 =1  
桃桃姬:"...玩家A检定结果为13，豁免失败，受到34点火焰伤害，实际受到17点伤害..."  
玩家A:   
..l 激励  
桃桃姬:"...玩家A检定结果为20，豁免成功，受到17点火焰伤害，实际受到8点伤害..."   

#### 特质与物品检定  
伴随着角色的成长，你的角色会获得各种各样的可以使用的特质与物品。他们的检定很难通过上述模块来完成。因此诞生了特质与物品检定模块。  
职业检定模块会伴随着开发不断被完善，而物品模块与额外特质模块属于定制功能。如果有需求，请联系开发者。  
使用<kbd>..c</kbd> <kbd>技能名称</kbd>指令进行职业技能检定。示例如下:   
>..c 拨挡飞弹  
..c 火行者  
..c 狂暴  
..c 欢欣之息  

##### 术士职业检定  
生成法术位:需要生成的法术位请用空格隔开，会消耗相应的术法点。  
生成术法点:用于转换成术法点的法术位请用空格隔开，如果满足转换条件，它们会被消耗掉。  
>..c 生成法术位 1 1 2  
..c 生成术法点 1 1 2 2 5  
..c 超魔法 3  

##### 法师职业检定  
>..c 奥术回想 1 1 2  

##### 战士职业检定  
>..c 回气  

##### 野蛮人职业检定  
>..c 狂暴  

##### 武僧职业检定  
>..c 拨挡飞弹  

#### 生命计算  
你随时可以通过以下指令来控制你的当前生命值/最大生命值/临时生命值。  
>..+5 (增加5点HP)  
..-10 (减少10点HP)  
..+6t (增加6点临时生命值)  
..-10l (减少10点最大生命值,这个效果是临时的，不会影响到你原本的最大生命值。)  

#### 生命骰计算  
你随时可以通过以下指令来控制你的生命骰。注意的是生命骰也会随着长休恢复。  
生命骰功能是一个未开发完全的简易的模块，目前只能提供最基本的计数功能，如果你启用了兼职，那么你很可能需要手动记录生命骰。  
>..生命骰+5 (增加5颗生命骰)  
..hd-10 (减少10颗生命骰)  

#### 使用弹药  
远程武器可以使用具有魔法加值的弹药。但是只有具有远程武器才可以使用弹药。     

**设置弹药数量**    
使用<kbd>.弹药 弹药种类 弹药数量</kbd>来设置库存弹药数量。弹药种类可以是数字，也可以是诸如+2或+3这样的字符串。   
>.弹药 +3 30  
.弹药 2 30  

**设置当前使用弹药**  
使用<kbd>.弹药 弹药种类</kbd>来设置库存弹药数量。同样，弹药种类可以是数字，也可以是诸如+2或+3这样的字符串。   
>.弹药 +3  
.弹药 1  
.弹药 +2  

**回收弹药**  
使用<kbd>.回收弹药</kbd>指令根据DnD回收弹药规则回收消耗的弹药。  

#### 设置激励骰  
你随时可以通过以下指令来设置你可用的激励骰。  
激励骰可以同于属性/豁免/攻击检定，而勇气学院的诗人可以让你的激励骰用于伤害检定中。如何使用激励骰请参见第六章。  
激励的检定参数一般用于二次检定中，参考本章节的二次检定了解详情。  
>..激励 D6  
..激励 1D12  

#### 财富记录    
你随时可以通过以下指令来增减你的财富，这项指令支持英文与中文输入。(你的财富无法将至0以下)    
>..-50gp  
..-3000sp  
..-600gp-800pp   

### 五、时间  
时间在dnd中是一个较为模糊的概念。它具体体现在战斗轮次、昼夜更替中。  

#### 战斗 
在战斗时，你会获得各种各样的效果，他们多半会伴随着时间限制对你的人物进行修正。这可以体现为属性的升降或行为模式的变化。  
如果你需要引入时间(轮次)系统，那么在每个你的回合开始时，你需要进行一次回合开始与结束检定。  
某些物品或特质会给予你回合开始和结束时进行检定的效果。当你拥有这样的效果越多，每次回合开始与结束时的检定会变得更加繁琐。  
如果你使用了战斗轮系统，那么在你的回合开始时，会自动进行这些检定。  
使用<kbd>..turn</kbd>或<kbd>..t</kbd>手动进行回合开始与结束检定。  

##### 战斗轮系统  
要使用战斗轮的相关功能，需要首先了解DnD战斗轮次的相关知识。  
如果你同时有多名角色/随从加入了战斗，那么在进行这些角色的轮次时，会**自动**切换你的当前选择角色为该角色。   
如果你觉得上述说法很拗口，那么你可以想象你在玩某个第三人称视角的RPG游戏，你只能控制一名角色，当轮到属于你的角色的轮次是，你的当前控制人物会自动切换至该人物。  
偷袭轮暂未支持，请自行进行。  

**辅助指令**  
你可以使用辅助指令查看当前战场情况:  
<kbd>.所有角色</kbd>    查看同一个群组内的所有玩家创建的角色。  
<kbd>.切换</kbd>    手动切换至本局游戏中某个你创建的角色。  
<kbd>.先攻</kbd>    查看当前先攻顺序表。(只有进行先攻检定后，才可以使用本指令查看先攻顺序表。)  
<kbd>.设置先攻 名称 数值</kbd>    为某个进入战斗轮的角色指定先攻值。  

**准备阶段**  
<kbd>.select 生物名称</kbd>    创建一名生物，一般为玩家使用指令。  
<kbd>.召唤 生物名称\*n</kbd>    召唤数量为n的生物，并为他们按顺序编号。如果你不填写数量，那么只会召唤1名生物。  
<kbd>.先攻检定</kbd>    创建战局，使所有角色和和被召唤的生物进行先攻检定(不包括随从)，并生成战斗及顺序表。  

**战斗阶段**  
<kbd>.开始</kbd>或<kbd>.开始战斗</kbd>  根据已经创建的先攻顺序表开始一场战斗。  
<kbd>.结束</kbd>    结束你当前控制角色的回合。  
<kbd>.加入 生物名称\*n</kbd>    在战斗开始后中途加入n名生物并根据先攻检定结果加入顺序表。如果你没有输入数量(*n)，并且该生物名已经存在，那么会直接将该生物加入战局，并骰掷先攻。  
<kbd>.离开 生物名称</kbd>或<kbd>.死亡 生物名称</kbd>    使得某名生物离开战斗。如果你在战斗开始前且先攻检定后使用，则会删除该生物。  
<kbd>.删除 生物名称</kbd>    在战局中将某个生物抹除(在先攻表中不会以脱战的状态显示而是会被删除)。需要注意的是，如果这个生物是你的随从，你仍然可以通过随从命令控制该生物进行检定。   

**尾声阶段**   
<kbd>.结束战斗</kbd>或<kbd>.结算</kbd>  删除已经死亡的角色，并结束战斗轮。  

**不常用指令**   
<kbd>.新游戏</kbd>  清除所有群组内角色。玩家需要重新选择角色才可以使得他们再次加入战斗。    

##### 法术效应  
某些法术/能力/物品在使用后存在法术效应，例如护盾术，加速术，会给你提供限时的AC加值等。  
他们在桃桃姬的时间系统里会分别进行计算。伴随着时间的流逝，某些具有时效法术效应会失效。短休为经过一小时，而长休为经过八小时。  

**结束法术效应**  
使用<kbd>.取消 效应A</kbd>自行结束名为效应A的效应。  

**等待时间**  
在某些特殊的情况下，你不需要休息而希望时间推进的话。可以使用<kbd>..等待 TIME</kbd>的指令。  
使用此指令不视为你的角色进行了任何种类的休息，因此并不会恢复任何资源。  
使用h、m、s来代替TIME参数。如果你希望等待指定轮次，则只需要输入数字即可。  
示例如下:  
>..等待 5  
..等待 6h30m8s  
..等待 30m  

#### 昼夜更替
我们不妨将视角放的宏观一些。在DnD世界的冒险中，伴随着昼夜更替，你的能力或者具有充能的魔法物品会重新变得可以使用。  
使用<kbd>..longrest</kbd>或<kbd>..长休</kbd>后，你的物品会根据其特性重新获得充能。  

------

### 六、可选参数  
检定参数会对检定产生影响，它可能会改变检定骰的大小，也可能会改变检定的规则。  
举个最简单的例子，在同伴对某个生物释放了光曳弹之后，你攻击这个生物会获得优势。此时，你就需要在命令后输入优势检定参数来骰出两个D20骰并取骰点较大的那一个。这样桃桃姬就会理解你所需要的条件。   
>..a 剑 优势  

检定参数和命令之间需要使用空格隔开，同样，一条命令中如果含有多个检定参数，也同样需要用空格将他们隔开。比如:  
>..m 灼热射线+4 优势 咒剑  
..a 弓 劣势  
..a 匕首 副手 重击  

某些检定参数会伴随着资源的消耗。比如圣武士的至圣斩，邪术师的魔能斩击。你可以在参数的后面标注消耗的资源数值。   
如果你不标注数值，则会默认消耗最高环位(资源)。  
>..a 长弓 魔能斩击
..l 魔能斩击5

还有更多可公开的检定参数在下表列出，你可以根据你的需要使用。  

#### 通用可选检定参数  
* <kbd>-a</kbd>或<kbd>优势</kbd>   
适用范围:任何需要攻击或属性/技能检定的指令。    
具体作用:详见PHB优势相关说明。  
* <kbd>-d</kbd>或<kbd>劣势</kbd>   
适用范围:任何需要攻击或属性/技能检定的指令。    
具体作用:详见PHB劣势相关说明。  
* <kbd>-ac</kbd>或<kbd>精准</kbd>   
适用范围:任何需要攻击或属性/技能检定的指令。    
具体作用:你的本次检定骰出三个骰子，选出一个最高值作为基础检定结果。  
(如果你拥有特质精灵之准，你不必每次都输入检定参数，请参考第七章被动特质)。   
* <kbd>-s</kbd>或<kbd>副手</kbd>   
适用范围:武器攻击检定。    
具体作用:为检定添加副手效果修正。  
* <kbd>-sp</kbd>或<kbd>特殊</kbd>   
适用范围:法术检定。  
具体作用:无视环位进行法术检定。  
* <kbd>-ct</kbd>或<kbd>重击</kbd>   
适用范围:含有攻击检定的指令。  
具体作用:无视一切重击判定,强制命中并达成重击。   
注意事项:如果你在二次检定中使用了本参数并不会保留已经骰掷出的伤害骰，而是会重新骰掷，所以有较低概率会得到更低的伤害值。  
* <kbd>-at</kbd>或<kbd>必中</kbd>   
适用范围:含有攻击检定的指令。  
具体作用:强制命中。   

#### 职业可选检定参数(可公开的)  
* <kbd>-sa</kbd>或<kbd>偷袭</kbd>   
适用范围:攻击检定。游荡者职业限定。  
具体作用:在伤害骰中加入偷袭调整参数。  
* <kbd>-ins</kbd>或<kbd>激励</kbd>   
适用范围:攻击、属性、豁免检定。  
具体作用:在相应检定中加入激励调整参数。  
* <kbd>-dins</kbd>或<kbd>伤害激励</kbd>   
适用范围:伤害检定。  
具体作用:在伤害检定中加入激励调整参数。  
* <kbd>-hc</kbd>或<kbd>咒剑</kbd>   
适用范围:伤害检定。邪术师职业限定。  
具体作用:在攻击骰中加入重击调整参数，在伤害骰中加入咒剑诅咒调整参数。  
* <kbd>-mnz</kbd>或<kbd>魔能斩击</kbd>   
适用范围:伤害检定。邪术师职业限定。  
具体作用:在伤害骰中加入魔能斩击调整参数并扣除环位。  
* <kbd>-gfb</kbd>或<kbd>翠炎剑</kbd>   
适用范围:攻击检定。施法者职业。  
具体作用:详见翠炎剑法术描述。 
* <kbd>-bb</kbd>或<kbd>轰雷剑</kbd>   
适用范围:攻击检定。施法者职业。  
具体作用:详见轰雷剑法术描述。  
* <kbd>-bl</kbd>或<kbd>祝福</kbd>   
适用范围:详见祝福术。 
* <kbd>-ba</kbd>或<kbd>灾祸</kbd>   
适用范围:详见灾祸术。  
* <kbd>-mo</kbd>或<kbd>月镰</kbd>  
适用范围:治疗系法术检定。  
具体作用:治疗系法术增加1D4的回复骰。  
* <kbd>-ds</kbd>或<kbd>灵袭</kbd>   
适用范围:游侠。  
具体作用:伤害检定增加1D4(11级后为1D6)心灵伤害骰。  
* <kbd>-dis</kbd>或<kbd>神击</kbd>   
适用范围:牧师。  
具体作用:伤害检定增加1D8(11级后为2D8)光耀伤害骰。  
* <kbd>-hw</kbd>或<kbd>光翼</kbd>   
适用范围:阿斯莫种族。  
具体作用:伤害检定增加等同于你人物等级的光耀伤害。  
* <kbd>-gr</kbd>或<kbd>无情</kbd>   
适用范围:获得了无情者护符并与之同调的角色。  
具体作用:杀死一个生物后，下一次攻击检定取得优势，并增加1D10的黯蚀伤害骰。  
* <kbd>-hmdp</kbd>或<kbd>毁灭斗篷</kbd>   
适用范围:获得了凯尔米多斯的毁灭斗篷并与之同调的角色。  
具体作用:当你消耗法术位对一个目标造成伤害时：若该目标生命值原本为满，则额外造成1D12点力场伤害。  

 
------
### 七、特质  

你的人物在伴随着冒险会得到成长，这可以体现为一件能增强你的物品，亦或是一种特质。   
在录入特质时，需要在特质后加上<kbd>+</kbd>。示例：   
>[体质豁免 巧手* 苦痛魔爆+ 防护斗篷+ 火焰抗性- 光耀免疫-]  

#### 通用特质  
* <kbd>幸运</kbd>  
适用范围:半身人或拥有相同特质的角色。    
具体作用:当你在攻击/属性/豁免检定中骰出1时，你可以再骰一次，但是你必须接受本次的结果。  
* <kbd>精灵之准</kbd>  
适用范围:精灵或半精灵或拥有相同特质的角色。    
具体作用:当你在依靠敏捷，智力，感知或者魅力进行的攻击骰上有优势的时候，你可以重扔其中一个骰子。(默认重骰最小的骰子)  
* <kbd>苦痛魔爆</kbd>  
适用范围:邪术师    
具体作用:施展*魔能爆 eldritch blast*时，你可以将魅力调整值加到其每次命中所造成的伤害中。  
* <kbd>凶蛮重击</kbd>  
适用范围:野蛮人    
具体作用:详见PHB相关说明。  
* <kbd>幸运石</kbd>  
适用范围:任何获得幸运石物品或相同特质的角色。    
具体作用:属性与豁免检定获得+1加值。  
* <kbd>防护斗篷</kbd>  
适用范围:任何获得防护斗物品或相同特质的角色。    
具体作用:豁免检定获得+1加值。  
* <kbd>生命门徒</kbd>  
适用范围:牧师    
具体作用:详见技能相关说明。  
* <kbd>神佑医者</kbd>  
适用范围:牧师    
具体作用:详见技能相关说明。  
* <kbd>妖冶娴都</kbd>  
适用范围:游侠    
具体作用:详见技能相关说明。  
* <kbd>什米克之戒(绿)</kbd>  
适用范围:任何获得什米克之戒(绿)物品或相同特质的角色。   
具体作用:当你的回合开始时，进行一次d6检定，若结果大于等于3，获得1D6+1点临时生命值。  
* <kbd>扎卡的尖刺手套</kbd>  
适用范围:任何获得扎卡的尖刺手套物品或相同特质的角色。   
具体作用:你的徒手打击增加1点穿刺伤害。  
* <kbd>凯尔米多斯的毁灭斗篷</kbd>  
适用范围:任何获得凯尔米多斯的毁灭斗篷物品或相同特质的角色。   
具体作用:当你进行消耗法术位的行为时，进行一次D6检定。若结果等于6。则不会消耗该法术位。  
每回合开始时，进行一次D6检定，若结果大于4。继续进行一次D100的骰掷并对照下表产生一种相应的效应。    

#### 职业特质  
* <kbd>时械之魂</kbd>  
适用范围:术士子职业时械之魂。    
具体作用:参照子职业说明。添加相应职业资源。  
* <kbd>生命领域</kbd>  
适用范围:牧师子职业生命领域。    
具体作用:参照子职业说明。添加相应职业资源。  



------
### 八、随从
如果你是法师或者是邪术师等职业，亦或者招募了随从，那么你很可能需要操纵你复数角色进行检定。你不必每次使用<kbd>.切换 角色名</kbd>命令切换角色。桃桃姬提供了随从模块让你可以进行快捷的检定。

#### 召唤随从    
在使用<kbd>.select</kbd>命令选中了你的角色后，使用<kbd>..pset</kbd>指令就可以从你上传的角色中召唤一名作为随从。示例如下:  
>..pset 德拉克铁锤  

!> 请注意桃桃姬目前不支持一名角色拥有复数的随从。如果你无论如何都需要使用多名随从(尽管我非常不推荐这样做)，请尝试为随从召唤随从。  
>..ppset 德拉克木锤  

#### 随从检定    
随从模块的设计理念源自于便捷，因此不会有任何额外的指令。如果你需要使用你的随从进行检定，只需要在<kbd>指令</kbd>与<kbd>..</kbd>中添加一个<kbd>p</kbd>即可。尝试理解以下指令：
>..pa 长弓 优势  
..ps 体质豁免 劣势  
..pm 魔法飞弹+4 咒剑  
..ppa 斧    
..plongrest  
..pc 狂暴  

------

### 九、FAQ  

**-Q-**:为什么有的指令前是..而有的指令前是.？太不好记了！  
**-A-**:大致可以理解为：需要输入<kbd>..</kbd>的指令是你所创建的角色可以进行的行为。而需要输入<kbd>.</kbd>的指令是DnD世界外玩家(你)可以进行的行为。  

**-Q-**:我的指令正确，桃桃姬却没有做出回应？  
**-A-**:造成这种问题的原因有很多，你可以首先尝试一些简单的指令例如<kbd>.d</kbd>来确认一下桃桃姬是否在线。如果不在线，可以在1分钟后继续尝试。桃桃姬在掉线后会尝试重新登陆。  
在排除上述可能后，还有以下可能会导致这个问题:  
* 你可能被加入了黑名单。  
* 你当前的角色的录入数据存在异常。  
* 桃桃姬的代码存在未发现的bug。  
* 桃桃姬被tx封禁。  
你可以与开发者(本页最顶部已注明)进行联系，尝试解决这个问题。  

**-Q-**:查询功能支持物品搜索吗？  
**-A-**:查询功能目前只支持法术查询，也许以后会增加物品查询功能。开发者不推荐玩家阅读城主手册中的内容，这是**不必要**的。    

------

### 终、更新与开发日志  
#### 开发中的功能   

*dnd_buff模块优化*  > 当前进度:0%,1/1  
*生命骰模块*  > 当前进度:0%,1/1    
*随机地下城生成模块*   > 当前进度:5%,1/5    
*地下城模块*   
*随机生物生成模块*    
*随机护甲生成模块*     
*随机物品生成模块*   

#### 实验性功能    

你可以在桃桃姬的最新版本中体验到下列实验性功能特性。它们经过了一段时间的测试，但也许是不稳定的。   
**武器模块架构**    
*武器模块现在支持DnD中所有攻击模式。*     

**二次检定动态更新**   
*二次检定可以实时读取检定数据和生物属性的变化。根据这些变化来重计算检定结果。*    

**桃桃姬DnD2.0模块**    
*桃桃姬DnD2.0模块为后续版本的更新提供了更为便利的方式。所有在0.23.0版本后的功能都依赖该模块运行。*    

#### 长期工作   

* DnD特质收录    

*有的特质收录较为简单，而少数特质会对桃桃姬的系统架构产生影响。*    


------
#### 更新日志 0.25   
##### 0.25.6  
*修正了一些错误。*    
*现在你可以为战斗轮中的角色手动设置先攻检定结果。*
##### 0.25.5  
*修正了一些错误。*    
##### 0.25.4  
*修正了一些DnD2.0模块的错误。*    
##### 0.25.3  
*武器模块现在可以录入武器属性。*    
##### 0.25.2  
*修复一系列架构更新带来的bug。*  
*添加了弹药模块。武器属性现在可以按照远程和近战分类(待更新)。*   
##### 0.25.1  
*需要目标进行豁免检定的攻击现在可以实时读取目标的二次检定结果。(结果也会发生改变)*     
##### 0.25.1  
*属性/技能检定现在支持二次检定。*     
##### 0.25.0  
*更新了读档与存档模块。*    
*新增了财富记录功能。*   

#### 更新日志 0.24  
##### 0.24.1
*修正了一系列bug。*   
##### 0.24.0
*法术模块更新。现在攻击和豁免类法术支持选定目标，攻击类法术支持二次检定。(多重攻击选择不同目标待优化。)*   

#### 更新日志 0.23  
##### 0.23.5
*现在可以在武器检定中使目标进行豁免检定并计算伤害了。*  
##### 0.23.4  
*修正了二次检定中偶尔攻击计算bug的问题。*   
##### 0.23.3  
*新增了快捷编号功能。现在可以更简单的选中任意一个生物了。*   
##### 0.23.2  
*修复了一系列更新架构带来的问题。*  
*增加了检定参数*  
##### 0.23.1  
*代码架构优化。*  
*增加了二次检定模块。*   
##### 0.23.0  
*代码架构优化。*  

#### 更新日志 0.22  
##### 0.22.4  
*增加了激励模块，以及相关检定参数。*  
##### 0.22.3  
*现在攻击命中目标后的专注豁免只会显示豁免结果，而不会自动取消专注。*  
##### 0.22.2  
*修复战斗轮系统的一些罕见BUG。*  
##### 0.22.1  
*更新战斗轮系统。*  
##### 0.22.0  
*添加了战斗轮系统。*  
*现在开始法术检定会显示每个骰子的大小。*  

#### 更新日志 0.21  
##### 0.21.5   
*现在你可以通过指定名字的方式来选定目标。*  
*增加了生命计数相关功能*  
*现在攻击会分别判定目标的AC值并根据抗性免疫易伤属性计算实际伤害。*  
*现在攻击命中目标的同时会触发目标身上需要专注法术的体质豁免。*  
##### 0.21.4   
*现在为攻击指定目标后可以判断目标的抗性以及护甲值。*  
##### 0.21.3   
*添加术士模块*  
##### 0.21.2   
*添加随机武器生成模块。*  
##### 0.21.1   
*现在单次攻击检定可以指定多个目标。*  
##### 0.21.0    
*现在攻击检定可以根据目标的抗性等计算实际造成的伤害。*  
*修复了一些罕见的bug。*  

#### 更新日志 0.20  
##### 0.20.2  
*更新特质与检定参数*  
##### 0.20.1  
*修复了开关型特质在同一回合关闭后再开启不会实时更新的问题。*
##### 0.20.0  
*添加了物品模块。*
*物品检定现在可以在<kbd>..c</kbd>特质与物品检定中使用。*  
*现在短休会清除较短的buff效果，而长休会回复物品充能。*  

#### 更新日志 0.19  
##### 0.19.2  
*添加了buff模块。*  
*现在剩余时间大于10轮的buff会以分钟显示*  
##### 0.19.1  
*添加了光翼检定参数。*  
##### 0.19.0  
*修复了武器录入无法将挥砍、穿刺和钝击以外的伤害类型识别为主武器伤害类型的问题。*   
*添加了回合开始与结束检定模块。*   

#### 更新日志 0.18  
*更新日志及说明文档转移到Github*  
*添加了随从模块。*  
*更新检定参数库。*  
